{"ast":null,"code":"var _s = $RefreshSig$();\nimport React, { useState, useEffect } from 'react';\nconst SpotifyPlayer = ({\n  uri,\n  isPlaying,\n  onPlayPause\n}) => {\n  _s();\n  const [player, setPlayer] = useState(null);\n  const [deviceId, setDeviceId] = useState(null);\n  const [isReady, setIsReady] = useState(false);\n  useEffect(() => {\n    const script = document.createElement(\"script\");\n    script.src = \"https://sdk.scdn.co/spotify-player.js\";\n    script.async = true;\n    document.body.appendChild(script);\n    window.onSpotifyWebPlaybackSDKReady = () => {\n      const player = new window.Spotify.Player({\n        name: 'SpotCIRCLE Web Player',\n        getOAuthToken: cb => {\n          cb(localStorage.getItem('spotify_access_token'));\n        },\n        volume: 0.5\n      });\n      player.addListener('initialization_error', ({\n        message\n      }) => {\n        console.error('Failed to initialize:', message);\n      });\n      player.addListener('authentication_error', ({\n        message\n      }) => {\n        console.error('Failed to authenticate:', message);\n        // Refresh token on auth error\n        const refreshToken = localStorage.getItem('spotify_refresh_token');\n        if (refreshToken) {\n          fetch('http://localhost:5001/api/auth/refresh', {\n            method: 'GET',\n            headers: {\n              'Content-Type': 'application/json'\n            },\n            params: {\n              refresh_token: refreshToken\n            }\n          }).then(response => response.json()).then(data => {\n            localStorage.setItem('spotify_access_token', data.access_token);\n            window.location.reload();\n          }).catch(error => {\n            console.error('Error refreshing token:', error);\n          });\n        }\n      });\n      player.addListener('account_error', ({\n        message\n      }) => {\n        console.error('Failed to validate Spotify account:', message);\n      });\n      player.addListener('playback_error', ({\n        message\n      }) => {\n        console.error('Failed to perform playback:', message);\n      });\n      player.addListener('player_state_changed', state => {\n        if (state) {\n          onPlayPause && onPlayPause(!state.paused);\n        }\n      });\n      player.addListener('ready', ({\n        device_id\n      }) => {\n        console.log('Ready with Device ID', device_id);\n        setDeviceId(device_id);\n        setIsReady(true);\n        setPlayer(player);\n      });\n      player.addListener('not_ready', ({\n        device_id\n      }) => {\n        console.log('Device ID has gone offline', device_id);\n        setIsReady(false);\n      });\n      player.connect();\n    };\n    return () => {\n      if (player) {\n        player.disconnect();\n      }\n    };\n  }, []);\n  useEffect(() => {\n    if (!uri || !isReady || !deviceId) return;\n    const play = async () => {\n      try {\n        await fetch(`https://api.spotify.com/v1/me/player/play?device_id=${deviceId}`, {\n          method: 'PUT',\n          body: JSON.stringify({\n            uris: [uri]\n          }),\n          headers: {\n            'Content-Type': 'application/json',\n            'Authorization': `Bearer ${localStorage.getItem('spotify_access_token')}`\n          }\n        });\n      } catch (error) {\n        console.error('Error starting playback:', error);\n      }\n    };\n    play();\n  }, [uri, isReady, deviceId]);\n  useEffect(() => {\n    if (!player) return;\n    if (isPlaying) {\n      player.resume().catch(error => {\n        console.error('Error resuming playback:', error);\n      });\n    } else {\n      player.pause().catch(error => {\n        console.error('Error pausing playback:', error);\n      });\n    }\n  }, [isPlaying, player]);\n  return null;\n};\n_s(SpotifyPlayer, \"kplLX/5I7RpTn6FC2X8dCN50v+E=\");\n_c = SpotifyPlayer;\nexport default SpotifyPlayer;\nvar _c;\n$RefreshReg$(_c, \"SpotifyPlayer\");","map":{"version":3,"names":["React","useState","useEffect","SpotifyPlayer","uri","isPlaying","onPlayPause","_s","player","setPlayer","deviceId","setDeviceId","isReady","setIsReady","script","document","createElement","src","async","body","appendChild","window","onSpotifyWebPlaybackSDKReady","Spotify","Player","name","getOAuthToken","cb","localStorage","getItem","volume","addListener","message","console","error","refreshToken","fetch","method","headers","params","refresh_token","then","response","json","data","setItem","access_token","location","reload","catch","state","paused","device_id","log","connect","disconnect","play","JSON","stringify","uris","resume","pause","_c","$RefreshReg$"],"sources":["C:/Users/samly/Desktop/CvProjects/SpotCIRCLE/frontend/src/components/SpotifyPlayer.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\n\nconst SpotifyPlayer = ({ uri, isPlaying, onPlayPause }) => {\n  const [player, setPlayer] = useState(null);\n  const [deviceId, setDeviceId] = useState(null);\n  const [isReady, setIsReady] = useState(false);\n\n  useEffect(() => {\n    const script = document.createElement(\"script\");\n    script.src = \"https://sdk.scdn.co/spotify-player.js\";\n    script.async = true;\n\n    document.body.appendChild(script);\n\n    window.onSpotifyWebPlaybackSDKReady = () => {\n      const player = new window.Spotify.Player({\n        name: 'SpotCIRCLE Web Player',\n        getOAuthToken: cb => {\n          cb(localStorage.getItem('spotify_access_token'));\n        },\n        volume: 0.5\n      });\n\n      player.addListener('initialization_error', ({ message }) => {\n        console.error('Failed to initialize:', message);\n      });\n\n      player.addListener('authentication_error', ({ message }) => {\n        console.error('Failed to authenticate:', message);\n        // Refresh token on auth error\n        const refreshToken = localStorage.getItem('spotify_refresh_token');\n        if (refreshToken) {\n          fetch('http://localhost:5001/api/auth/refresh', {\n            method: 'GET',\n            headers: {\n              'Content-Type': 'application/json'\n            },\n            params: { refresh_token: refreshToken }\n          })\n          .then(response => response.json())\n          .then(data => {\n            localStorage.setItem('spotify_access_token', data.access_token);\n            window.location.reload();\n          })\n          .catch(error => {\n            console.error('Error refreshing token:', error);\n          });\n        }\n      });\n\n      player.addListener('account_error', ({ message }) => {\n        console.error('Failed to validate Spotify account:', message);\n      });\n\n      player.addListener('playback_error', ({ message }) => {\n        console.error('Failed to perform playback:', message);\n      });\n\n      player.addListener('player_state_changed', state => {\n        if (state) {\n          onPlayPause && onPlayPause(!state.paused);\n        }\n      });\n\n      player.addListener('ready', ({ device_id }) => {\n        console.log('Ready with Device ID', device_id);\n        setDeviceId(device_id);\n        setIsReady(true);\n        setPlayer(player);\n      });\n\n      player.addListener('not_ready', ({ device_id }) => {\n        console.log('Device ID has gone offline', device_id);\n        setIsReady(false);\n      });\n\n      player.connect();\n    };\n\n    return () => {\n      if (player) {\n        player.disconnect();\n      }\n    };\n  }, []);\n\n  useEffect(() => {\n    if (!uri || !isReady || !deviceId) return;\n\n    const play = async () => {\n      try {\n        await fetch(`https://api.spotify.com/v1/me/player/play?device_id=${deviceId}`, {\n          method: 'PUT',\n          body: JSON.stringify({ uris: [uri] }),\n          headers: {\n            'Content-Type': 'application/json',\n            'Authorization': `Bearer ${localStorage.getItem('spotify_access_token')}`\n          },\n        });\n      } catch (error) {\n        console.error('Error starting playback:', error);\n      }\n    };\n\n    play();\n  }, [uri, isReady, deviceId]);\n\n  useEffect(() => {\n    if (!player) return;\n\n    if (isPlaying) {\n      player.resume().catch(error => {\n        console.error('Error resuming playback:', error);\n      });\n    } else {\n      player.pause().catch(error => {\n        console.error('Error pausing playback:', error);\n      });\n    }\n  }, [isPlaying, player]);\n\n  return null;\n};\n\nexport default SpotifyPlayer;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}